select column_name, data_type, 'count(distinct "'||column_name||'"),' as cmd
from svv_columns
where table_catalog='rudderdw'
and table_schema='rudder'
and table_name in ('identifies', 'tracks', 'pages', 'stripe_customers', 'stripe_charges', 'stripe_invoices', 'stripe_subscriptions', 'stripe_balance_history', 'qry_rs_transaction_detail', 'question_answered', 'sendgrid_rudder_suppression_group_members', 'intercomv_1_users', 'sendgrid_rudder_bounces', 'sendgrid_rudder_spam_reports', 'rs_ltv_prediction_results_latest')
and table_name='tracks'
order by table_name, ordinal_position


SELECT
count(*),
count(distinct "anonymous_id"),
count(distinct "channel"),
count(distinct "context_app_build"),
count(distinct "context_app_name"),
count(distinct "context_app_namespace"),
count(distinct "context_app_version"),
count(distinct "context_destination_id"),
count(distinct "context_destination_type"),
count(distinct "context_ip"),
count(distinct "context_library_name"),
count(distinct "context_library_version"),
count(distinct "context_locale"),
count(distinct "context_page_initial_referring_domain"),
count(distinct "context_page_path"),
count(distinct "context_page_referrer"),
count(distinct "context_page_referring_domain"),
count(distinct "context_page_title"),
count(distinct "context_request_ip"),
count(distinct "context_screen_density"),
count(distinct "context_screen_height"),
count(distinct "context_screen_inner_height"),
count(distinct "context_screen_inner_width"),
count(distinct "context_screen_width"),
count(distinct "context_source_id"),
count(distinct "context_source_type"),
count(distinct "context_traits_email"),
count(distinct "context_traits_specialty_id"),
count(distinct "context_user_agent"),
count(distinct "event"),
count(distinct "event_text"),
count(distinct "id"),
count(distinct "original_timestamp"),
count(distinct "received_at"),
count(distinct "sent_at"),
count(distinct "timestamp"),
count(distinct "user_id"),
count(distinct "uuid_ts"),
count(distinct "context_sources_task_run_id"),
count(distinct "context_sources_job_id"),
count(distinct "context_sources_version"),
count(distinct "context_sources_job_run_id"),
count(distinct "context_sources_task_id"),
count(distinct "context_sources_batch_id"),
count(distinct "record_id"),
count(distinct "context_campaign_term"),
count(distinct "context_campaign_name"),
count(distinct "context_campaign_source"),
count(distinct "context_campaign_medium"),
count(distinct "context_campaign_content"),
count(distinct "context_campaign_click"),
count(distinct "context_session_id"),
count(distinct "context_session_start"),
count(distinct "context_campaign_sourc_20_e"),
count(distinct "context_page_initial_referrer"),
count(distinct "context_campaign_source_20"),
count(distinct "context_page_url"),
count(distinct "context_page_search"),
count(distinct "context_page_tab_url"),
count(distinct "context_campaign_campign"),
count(distinct "context_campaign_campai_ite_20_questions_20_on_20_afibgn"),
count(distinct "context_campaign_programme"),
count(distinct "context_campaign_20_campaign"),
count(distinct "context_traits_p"),
count(distinct "context_traits_utm_source"),
count(distinct "context_traits_uuid"),
count(distinct "context_traits_rnd"),
count(distinct "context_traits_origins"),
count(distinct "context_traits_campaign"),
count(distinct "context_traits_c"),
count(distinct "context_traits_action"),
count(distinct "context_traits_adv"),
count(distinct "context_traits_utm_campaign")
from rudder.tracks
